

import requests

from . import utils

from .bank_accounts import BankAccounts
from .fees import Fees
from .financial_products import FinancialProducts
from .investment_product_transactions import InvestmentProductTransactions
from .investment_products import InvestmentProducts
from .investor_accounts import InvestorAccounts
from .investors import Investors
from .payments import Payments
from .portfolio_templates import PortfolioTemplates
from .pots_holdings_and_transactions import PotsHoldingsAndTransactions
from .rates import Rates
from .rebalance import Rebalance
from .switch_instruction import SwitchInstruction
from .test_methods import TestMethods
from .utility import Utility
from .withdrawal import Withdrawal


SERVERS = [
	"https://wos-gb.demo.wealthos.cloud",
]


class SDK:
    
    bank_accounts: BankAccounts
    fees: Fees
    financial_products: FinancialProducts
    investment_product_transactions: InvestmentProductTransactions
    investment_products: InvestmentProducts
    investor_accounts: InvestorAccounts
    investors: Investors
    payments: Payments
    portfolio_templates: PortfolioTemplates
    pots_holdings_and_transactions: PotsHoldingsAndTransactions
    rates: Rates
    rebalance: Rebalance
    switch_instruction: SwitchInstruction
    test_methods: TestMethods
    utility: Utility
    withdrawal: Withdrawal

    _client: requests.Session
    _security_client: requests.Session
    
    _server_url: str = SERVERS[0]
    _language: str = "python"
    _sdk_version: str = "0.0.1"
    _gen_version: str = ""

    def __init__(self) -> None:
        self._client = requests.Session()
        self._security_client = requests.Session()
        self._init_sdks()


    def config_server_url(self, server_url: str, params: dict[str, str]):
        if params is not None:
            self._server_url = utils.replace_parameters(server_url, params)
        else:
            self._server_url = server_url

        self._init_sdks()
    

    def config_client(self, client: requests.Session):
        self._client = client
        self._init_sdks()
    
    
    def _init_sdks(self):
        
        self.bank_accounts = BankAccounts(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.fees = Fees(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.financial_products = FinancialProducts(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.investment_product_transactions = InvestmentProductTransactions(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.investment_products = InvestmentProducts(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.investor_accounts = InvestorAccounts(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.investors = Investors(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.payments = Payments(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.portfolio_templates = PortfolioTemplates(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.pots_holdings_and_transactions = PotsHoldingsAndTransactions(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.rates = Rates(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.rebalance = Rebalance(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.switch_instruction = SwitchInstruction(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.test_methods = TestMethods(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.utility = Utility(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
        
        self.withdrawal = Withdrawal(
            self._client,
            self._security_client,
            self._server_url,
            self._language,
            self._sdk_version,
            self._gen_version
        )
    
    